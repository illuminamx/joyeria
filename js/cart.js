let cart=JSON.parse(localStorage.getItem('illuminaCart'))||[];function saveCart(){localStorage.setItem('illuminaCart',JSON.stringify(cart))}
function addToCart(t,e){const r=productos[e].find(a=>a.id===t);cart.push({...r,catOrigin:e});saveCart();updateCartUI();const a=document.querySelector('.bi-bag').parentElement;a.classList.add('cart-bounce');setTimeout(()=>a.classList.remove('cart-bounce'),500);const c=document.getElementById('cartAlert');document.getElementById('alertMsg').innerText=`Agregado: ${r.name}`;c.classList.remove('d-none');setTimeout(()=>c.classList.add('d-none'),3000)}
function removeItem(t){cart.splice(t,1);saveCart();updateCartUI()}
function updateCartUI(){const t=document.getElementById('cartItemsContainer');let e=0;t.innerHTML=cart.map((t,r)=>{e+=t.price;return`<div class="d-flex align-items-center mb-4 border-bottom pb-3 animate-fade-down"><img src="imgs/${t.catOrigin}/${t.prefix}-${t.slug}-illumina.png" class="rounded-3 me-3" style="width:60px;height:60px;object-fit:cover"> <div class="flex-grow-1"><h6 class="small mb-0 ls-2 text-uppercase">${t.name}</h6><p class="gold-text small mb-0">$${t.price}</p></div><button onclick="removeItem(${r})" class="btn-icon p-1 opacity-50"><i class="bi bi-x-lg fs-6"></i></button></div>`}).join('');document.getElementById('cartTotal').innerText=`$${e.toFixed(2)}`;const r=document.getElementById('cartCount');if(cart.length>0){r.classList.remove('d-none')}else{r.classList.add('d-none');t.innerHTML='<div class="text-center py-5 opacity-25"><i class="bi bi-bag-x fs-1 d-block mb-3"></i><p class="small ls-2">TU BOLSA ESTÃ VACÃA</p></div>'}}
function forceOpenCart(){const t=bootstrap.Offcanvas.getInstance(document.getElementById('cartOffcanvas'));if(t)t.show()}
function generateTicket(){if(cart.length===0){const t=document.getElementById('emptyCartAlert');t.classList.remove('d-none');setTimeout(()=>t.classList.add('d-none'),3000);return}const e=document.getElementById('ticketContent');let r=0,a='<div class="text-center mb-4"><h6 class="ls-3 fw-bold">ILLÃšMINA</h6><p class="x-small opacity-50">JOYERÃA DE ALTA GAMA</p></div>';cart.forEach(t=>{r+=t.price;a+=`<div class="ticket-item"><span class="small text-uppercase">${t.prefix} ${t.name}</span><span class="small fw-bold">$${t.price}</span></div>`});a+=`<div class="d-flex justify-content-between mt-4 pt-2 border-top"><span class="fw-bold">TOTAL</span><span class="gold-text fw-bold">$${r.toFixed(2)}</span></div>`;e.innerHTML=a;ticketModalInstance.show()}
function sendWhatsAppOrder(){const t=document.getElementById('deliveryToggle').checked,e=document.getElementById('inputName').value,r=document.getElementById('inputCity').value;if(t&&(!e||!r)){alert('Por favor completa los campos de envÃ­o');return}let a='',c=0;cart.forEach(t=>{a+=`â€¢ ${t.prefix} ${t.name} - $${t.price}\n`;c+=t.price});const n=`$${c.toFixed(2)}`;let s='';if(t){s=`âœ¨ *ILLÃšMINA | PEDIDO CON ENVÃO* âœ¨\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nMe interesa el siguiente pedido:\n\n${a}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n*ğŸ’° TOTAL:* ${n}\n\nğŸ“ *DATOS DE ENVÃO:*\nğŸ‘¤ *Nombre:* ${e}\nğŸ  *DirecciÃ³n:* ${document.getElementById('inputAddress').value}\nğŸ˜ï¸ *Colonia:* ${document.getElementById('inputColonia').value}\nğŸ“® *CP:* ${document.getElementById('inputCP').value}\nğŸŒ *Ciudad:* ${r}\nğŸ“ *Tel:* ${document.getElementById('inputPhone').value}\n\nQuedo en espera de los datos bancarios.`}else{s=`âœ¨ *ILLÃšMINA | NUEVO PEDIDO* âœ¨\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nHola, me interesa agendar una entrega personal para:\n\n${a}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n*ğŸ’° TOTAL A PAGAR:* ${n}\n\nğŸ¤ *MÃ‰TODO:* Entrega Personal\nQuedo atento.`}const i="525657785749";window.open(`https://wa.me/${i}?text=${encodeURIComponent(s)}`,'_blank');cart=[];saveCart();updateCartUI();ticketModalInstance.hide();document.getElementById('deliveryToggle').checked=!1;toggleDeliveryForm()}